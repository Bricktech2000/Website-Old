<< consts.lang = '<<<yield consts.lang>>>' >>
<!-- dynamic watch.url and watch.path definitions -->
<!-- https://stackoverflow.com/questions/5817505/is-there-any-method-to-get-the-url-without-query-string -->
<< watch.url = window.location.pathname >>
<< watch.urlh = window.location.hash.replace(/^#/, '') >>
<< history.scrollRestoration = 'manual' >>
<< vars.firstLoad = 0; >>
<<
  var url = watch.url;
  history.pushState(null, null, url);
  window.scrollTo({top: 0, left: 0, behavior: 'smooth'});
  if(vars.firstLoad > 0) await utils.sleep(500);

  watch.path = url.split('?')[0].replace(/^\//, '').split('/');
  vars.firstLoad++;
>>
<<
  var hash = watch.urlh;
  if(hash) history.pushState(null, null, '#' + hash);
  if(vars.firstLoad > 1) await utils.sleep(500);
  watch.hash = hash;
  vars.firstLoad++;
>>
<<
  utils.redirect = (e) => {
    e.preventDefault();
    window.scrollTo({top: 0, left: 0, behavior: 'smooth'}); //if the url doesn't change
    //https://stackoverflow.com/questions/14721388/how-to-get-the-exact-href-value-only-without-their-domain
    //https://stackoverflow.com/questions/50149925/click-event-target-gives-element-or-its-child-not-parent-element
    watch.url = e.currentTarget.pathname; // || '/';
    watch.urlh = e.currentTarget.hash.replace(/^#/, '');
  }
>>
